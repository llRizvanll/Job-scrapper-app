/**
 * ATS (Applicant Tracking System) scraper configuration.
 * Pattern-based company job boards: Greenhouse, Lever, Ashby, Workable, SmartRecruiters, Breezy, BambooHR, Teamtailor.
 */
import type { JobSource } from '@/core/entities';

export interface ATSSelectors {
  jobContainer: string;
  title: string;
  location: string;
  department: string;
  link: string;
}

export interface ATSConfigItem {
  name: string;
  baseUrl: string;
  /** Path after baseUrl, use {company} for company slug. */
  jobListPath: string;
  selectors: ATSSelectors;
  pagination: boolean;
  apiAvailable: boolean;
}

export interface ATSCompany {
  name: string;
  slug: string;
}

/** Company list: display name -> URL slug */
const GREENHOUSE_COMPANIES: ATSCompany[] = [
  { name: 'DoorDash', slug: 'doordash' },
  { name: 'HubSpot', slug: 'hubspot' },
  { name: 'Dropbox', slug: 'dropbox' },
  { name: 'PlayStation', slug: 'playstation' },
  { name: 'Airbnb', slug: 'airbnb' },
  { name: 'Pinterest', slug: 'pinterest' },
  { name: 'Square', slug: 'square' },
  { name: 'Stripe', slug: 'stripe' },
  { name: 'Shopify', slug: 'shopify' },
  { name: 'Twilio', slug: 'twilio' },
  { name: 'Zoom', slug: 'zoom' },
  { name: 'Slack', slug: 'slack' },
  { name: 'Figma', slug: 'figma' },
  { name: 'Notion', slug: 'notion' },
  { name: 'Linear', slug: 'linear' },
  { name: 'Vercel', slug: 'vercel' },
  { name: 'Supabase', slug: 'supabase' },
  { name: 'Replit', slug: 'replit' },
  { name: 'Render', slug: 'render' },
  { name: 'Railway', slug: 'railway' },
  { name: 'Resend', slug: 'resend' },
  { name: 'Loops', slug: 'loops' },
  { name: 'Perplexity', slug: 'perplexity' },
  { name: 'Cursor', slug: 'cursor' },
  { name: 'Lovable', slug: 'lovable' },
  { name: 'Robinhood', slug: 'robinhood' },
  { name: 'Plaid', slug: 'plaid' },
  { name: 'Brex', slug: 'brex' },
  { name: 'Mercury', slug: 'mercury' },
  { name: 'Affirm', slug: 'affirm' },
  { name: 'SoFi', slug: 'sofi' },
  { name: 'Chime', slug: 'chime' },
  { name: 'Dave', slug: 'dave' },
  { name: 'Current', slug: 'current' },
  { name: 'Varo', slug: 'varo' },
  { name: 'Alloy', slug: 'alloy' },
  { name: 'Unit', slug: 'unit' },
  { name: 'Treasury Prime', slug: 'treasuryprime' },
  { name: 'Modern Treasury', slug: 'moderntreasury' },
  { name: 'Lithic', slug: 'lithic' },
  { name: 'Marqeta', slug: 'marqeta' },
  { name: 'Carta', slug: 'carta' },
  { name: 'AngelList', slug: 'angellist' },
  { name: 'Pipe', slug: 'pipe' },
  { name: 'Capchase', slug: 'capchase' },
  { name: 'Clearco', slug: 'clearco' },
  { name: 'Wayflyer', slug: 'wayflyer' },
  { name: 'Hims & Hers', slug: 'hims' },
  { name: 'Ro', slug: 'ro' },
  { name: 'Capsule', slug: 'capsule' },
  { name: 'Truepill', slug: 'truepill' },
  { name: 'Alto Pharmacy', slug: 'alto' },
  { name: 'Calm', slug: 'calm' },
  { name: 'Headspace', slug: 'headspace' },
  { name: 'Talkspace', slug: 'talkspace' },
  { name: 'BetterHelp', slug: 'betterhelp' },
  { name: 'Lyra Health', slug: 'lyra' },
  { name: 'Spring Health', slug: 'springhealth' },
  { name: 'Modern Health', slug: 'modernhealth' },
  { name: 'Ginger', slug: 'ginger' },
  { name: 'Included Health', slug: 'includedhealth' },
  { name: 'Transcarent', slug: 'transcarent' },
  { name: 'Roivant Sciences', slug: 'roivant' },
  { name: 'Recursion Pharma', slug: 'recursionpharma' },
  { name: 'Insitro', slug: 'insitro' },
  { name: 'Tempus', slug: 'tempus' },
  { name: 'Veracyte', slug: 'veracyte' },
  { name: 'Guardant Health', slug: 'guardanthealth' },
  { name: 'Exact Sciences', slug: 'exactsciences' },
  { name: 'Illumina', slug: 'illumina' },
  { name: "Macy's", slug: 'macys' },
  { name: 'Warby Parker', slug: 'warbyparker' },
  { name: 'Allbirds', slug: 'allbirds' },
  { name: 'Away', slug: 'away' },
  { name: 'Glossier', slug: 'glossier' },
  { name: 'Casper', slug: 'casper' },
  { name: 'Purple', slug: 'purple' },
  { name: 'Brooklinen', slug: 'brooklinen' },
  { name: 'Parachute', slug: 'parachute' },
  { name: 'Outdoor Voices', slug: 'outdoorvoices' },
  { name: 'Reformation', slug: 'reformation' },
  { name: 'Everlane', slug: 'everlane' },
  { name: 'Stitch Fix', slug: 'stitchfix' },
  { name: 'Rent the Runway', slug: 'renttherunway' },
  { name: 'Poshmark', slug: 'poshmark' },
  { name: 'Depop', slug: 'depop' },
  { name: 'StockX', slug: 'stockx' },
  { name: 'GOAT', slug: 'goat' },
  { name: 'Grailed', slug: 'grailed' },
  { name: 'ThredUp', slug: 'thredup' },
  { name: 'The RealReal', slug: 'therealreal' },
  { name: '1stDibs', slug: '1stdibs' },
  { name: 'Chairish', slug: 'chairish' },
  { name: 'AptDeco', slug: 'aptdeco' },
  { name: 'Burrow', slug: 'burrow' },
  { name: 'Salesforce', slug: 'salesforce' },
  { name: 'Zendesk', slug: 'zendesk' },
  { name: 'Atlassian', slug: 'atlassian' },
  { name: 'Asana', slug: 'asana' },
  { name: 'Monday.com', slug: 'monday' },
  { name: 'Coda', slug: 'coda' },
  { name: 'Airtable', slug: 'airtable' },
  { name: 'Smartsheet', slug: 'smartsheet' },
  { name: 'Workato', slug: 'workato' },
  { name: 'Zapier', slug: 'zapier' },
  { name: 'MuleSoft', slug: 'mulesoft' },
  { name: 'Segment', slug: 'segment' },
  { name: 'Amplitude', slug: 'amplitude' },
  { name: 'Mixpanel', slug: 'mixpanel' },
  { name: 'Heap', slug: 'heap' },
  { name: 'Pendo', slug: 'pendo' },
  { name: 'Gainsight', slug: 'gainsight' },
  { name: 'ChurnZero', slug: 'churnzero' },
  { name: 'Totango', slug: 'totango' },
  { name: 'Catalyst', slug: 'catalyst' },
  { name: 'Vitally', slug: 'vitally' },
  { name: 'Productboard', slug: 'productboard' },
];

const LEVER_COMPANIES: ATSCompany[] = [
  { name: 'Netflix', slug: 'netflix' },
  { name: 'Lyft', slug: 'lyft' },
  { name: 'Shopify', slug: 'shopify' },
  { name: 'Quora', slug: 'quora' },
  { name: 'Khan Academy', slug: 'khanacademy' },
  { name: 'Coursera', slug: 'coursera' },
  { name: 'Udemy', slug: 'udemy' },
  { name: 'Duolingo', slug: 'duolingo' },
  { name: 'Grammarly', slug: 'grammarly' },
  { name: 'Notion', slug: 'notion' },
  { name: 'Figma', slug: 'figma' },
  { name: 'Linear', slug: 'linear' },
  { name: 'Vercel', slug: 'vercel' },
  { name: 'Render', slug: 'render' },
  { name: 'Railway', slug: 'railway' },
  { name: 'Replit', slug: 'replit' },
  { name: 'AnyRoad', slug: 'anyroad' },
  { name: 'Workintech', slug: 'workintech' },
  { name: 'Evolutyz', slug: 'evolutyz' },
  { name: 'REGAL', slug: 'regal' },
  { name: 'Brex', slug: 'brex' },
  { name: 'Mercury', slug: 'mercury' },
  { name: 'Plaid', slug: 'plaid' },
  { name: 'Affirm', slug: 'affirm' },
  { name: 'Marqeta', slug: 'marqeta' },
  { name: 'Carta', slug: 'carta' },
  { name: 'AngelList', slug: 'angellist' },
  { name: 'Pipe', slug: 'pipe' },
  { name: 'Capchase', slug: 'capchase' },
  { name: 'Clearco', slug: 'clearco' },
  { name: 'Instacart', slug: 'instacart' },
  { name: 'Postmates', slug: 'postmates' },
  { name: 'DoorDash', slug: 'doordash' },
  { name: 'Caviar', slug: 'caviar' },
  { name: 'Grubhub', slug: 'grubhub' },
  { name: 'Seamless', slug: 'seamless' },
  { name: 'Eat24', slug: 'eat24' },
  { name: 'Delivery Hero', slug: 'deliveryhero' },
  { name: 'Foodpanda', slug: 'foodpanda' },
  { name: 'Gojek', slug: 'gojek' },
  { name: 'Grab', slug: 'grab' },
  { name: 'Rappi', slug: 'rappi' },
  { name: 'iFood', slug: 'ifood' },
  { name: 'Deliveroo', slug: 'deliveroo' },
  { name: 'Glovo', slug: 'glovo' },
  { name: 'Zomato', slug: 'zomato' },
  { name: 'Swiggy', slug: 'swiggy' },
  { name: 'Dunzo', slug: 'dunzo' },
  { name: 'Wolt', slug: 'wolt' },
  { name: 'Flink', slug: 'flink' },
];

const ASHBY_COMPANIES: ATSCompany[] = [
  { name: 'Snowflake', slug: 'snowflake' },
  { name: 'Netwealth', slug: 'netwealth' },
  { name: 'ShiftSmart', slug: 'shiftsmart' },
  { name: 'Oyster', slug: 'oyster' },
  { name: 'Deliveroo', slug: 'deliveroo' },
  { name: 'Altura', slug: 'altura' },
  { name: 'Flock Safety', slug: 'flocksafety' },
  { name: 'Juniper Square', slug: 'junipersquare' },
  { name: 'Aurora Solar', slug: 'aurorasolar' },
  { name: 'Brigit', slug: 'brigit' },
  { name: 'Coder', slug: 'coder' },
  { name: 'OAK', slug: 'oak' },
  { name: 'Costanoa Ventures', slug: 'costanoa' },
  { name: 'hyperexponential', slug: 'hyperexponential' },
  { name: 'Zello', slug: 'zello' },
  { name: 'The Job Sauce', slug: 'thejobsauce' },
  { name: 'Modern Treasury', slug: 'moderntreasury' },
  { name: 'Marshmallow', slug: 'marshmallow' },
  { name: 'Stytch', slug: 'stytch' },
  { name: 'Deel', slug: 'deel' },
  { name: 'Hopper', slug: 'hopper' },
  { name: 'Replit', slug: 'replit' },
  { name: 'Luma AI', slug: 'lumaai' },
  { name: 'Tacto', slug: 'tacto' },
  { name: 'Cryptio', slug: 'cryptio' },
  { name: 'Worldly', slug: 'worldly' },
  { name: '1Password', slug: '1password' },
  { name: 'Trainline', slug: 'trainline' },
  { name: 'Help Scout', slug: 'helpscout' },
  { name: 'GameChanger', slug: 'gamechanger' },
  { name: 'Cloakfield', slug: 'cloakfield' },
  { name: 'Nango', slug: 'nango' },
  { name: 'HackerOne', slug: 'hackerone' },
  { name: 'Machinify', slug: 'machinify' },
  { name: 'Solana Foundation', slug: 'solanafoundation' },
  { name: 'PostHog', slug: 'posthog' },
  { name: 'Calm', slug: 'calm' },
  { name: 'Quora', slug: 'quora' },
  { name: 'A1 Garage', slug: 'a1garage' },
  { name: 'Rad AI', slug: 'radai' },
  { name: 'Scribe', slug: 'scribe' },
  { name: 'VoltHire', slug: 'volthire' },
  { name: 'Local Infusion', slug: 'localinfusion' },
  { name: 'Sovos', slug: 'sovos' },
  { name: 'Axion Ray', slug: 'axionray' },
  { name: 'GrowthAssistant', slug: 'growthassistant' },
  { name: 'Talentful', slug: 'talentful' },
  { name: 'Leapsome', slug: 'leapsome' },
  { name: 'Supabase', slug: 'supabase' },
  { name: 'Teal', slug: 'teal' },
  { name: 'Vivante Health', slug: 'vivante' },
  { name: 'Misen', slug: 'misen' },
  { name: 'New Story', slug: 'newstory' },
  { name: 'UNISON', slug: 'unison' },
  { name: 'TheyDo', slug: 'theydo' },
  { name: 'Superhuman', slug: 'superhuman' },
  { name: 'Andela', slug: 'andela' },
  { name: 'Workiva', slug: 'workiva' },
  { name: 'Statista', slug: 'statista' },
  { name: 'Reprise', slug: 'reprise' },
  { name: 'mParticle', slug: 'mparticle' },
  { name: 'Cointracker', slug: 'cointracker' },
];

const WORKABLE_COMPANIES: ATSCompany[] = [
  { name: 'Virgin Management', slug: 'virginmanagement' },
  { name: 'Ryanair', slug: 'ryanair' },
  { name: 'Leonardo', slug: 'leonardo' },
  { name: 'Rentokil', slug: 'rentokil' },
  { name: 'Very Group', slug: 'verygroup' },
  { name: 'InVision', slug: 'invision' },
  { name: 'Starbucks', slug: 'starbucks' },
  { name: "Domino's", slug: 'dominos' },
  { name: 'Subway', slug: 'subway' },
  { name: 'Dunkin', slug: 'dunkin' },
  { name: "Baskin-Robbins", slug: 'baskinrobbins' },
  { name: "Papa John's", slug: 'papajohns' },
  { name: "Pizza Hut", slug: 'pizzahut' },
  { name: 'KFC', slug: 'kfc' },
  { name: 'Taco Bell', slug: 'tacobell' },
  { name: "Wendy's", slug: 'wendys' },
  { name: 'Burger King', slug: 'burgerking' },
  { name: "McDonald's", slug: 'mcdonalds' },
  { name: 'Chipotle', slug: 'chipotle' },
  { name: 'Panera', slug: 'panera' },
  { name: "Chick-fil-A", slug: 'chickfila' },
  { name: 'In-N-Out', slug: 'innout' },
  { name: 'Five Guys', slug: 'fiveguys' },
  { name: 'Shake Shack', slug: 'shakeshack' },
  { name: 'Sweetgreen', slug: 'sweetgreen' },
  { name: 'Lemonade', slug: 'lemonade' },
  { name: 'ChowNow', slug: 'chownow' },
  { name: 'Toast', slug: 'toast' },
  { name: 'Square', slug: 'square' },
  { name: 'Resy', slug: 'resy' },
  { name: 'OpenTable', slug: 'opentable' },
  { name: 'Yelp', slug: 'yelp' },
  { name: 'TripAdvisor', slug: 'tripadvisor' },
  { name: 'Booking.com', slug: 'booking' },
  { name: 'Expedia', slug: 'expedia' },
  { name: 'Kayak', slug: 'kayak' },
  { name: 'Priceline', slug: 'priceline' },
  { name: 'Agoda', slug: 'agoda' },
  { name: 'Eventbrite', slug: 'eventbrite' },
  { name: 'Meetup', slug: 'meetup' },
  { name: 'Cloudflare', slug: 'cloudflare' },
  { name: 'Fastly', slug: 'fastly' },
  { name: 'Akamai', slug: 'akamai' },
  { name: 'Mux', slug: 'mux' },
  { name: 'Vimeo', slug: 'vimeo' },
  { name: 'Cloudinary', slug: 'cloudinary' },
  { name: 'VMware', slug: 'vmware' },
  { name: 'Citrix', slug: 'citrix' },
  { name: 'Red Hat', slug: 'redhat' },
  { name: 'Docker', slug: 'docker' },
  { name: 'Canonical', slug: 'canonical' },
];

const SMARTRECRUITERS_COMPANIES: ATSCompany[] = [
  { name: 'Bosch', slug: 'BoschGroup' },
  { name: 'State Grid', slug: 'StateGrid' },
  { name: 'McKesson', slug: 'McKesson' },
  { name: 'Vitol', slug: 'Vitol' },
  { name: 'Microsoft', slug: 'Microsoft' },
  { name: 'Standard Bank', slug: 'StandardBank' },
  { name: 'IKEA', slug: 'IKEA' },
  { name: 'Visa', slug: 'Visa' },
  { name: 'LinkedIn', slug: 'LinkedIn' },
  { name: 'Twitter', slug: 'Twitter' },
  { name: 'Square', slug: 'Square' },
  { name: 'Uber', slug: 'Uber' },
  { name: 'Spotify', slug: 'Spotify' },
  { name: 'Adobe', slug: 'Adobe' },
  { name: 'Autodesk', slug: 'Autodesk' },
  { name: 'Siemens', slug: 'Siemens' },
  { name: "L'Oréal", slug: 'LOreal' },
  { name: 'Nestlé', slug: 'Nestle' },
  { name: 'Unilever', slug: 'Unilever' },
  { name: 'Procter & Gamble', slug: 'ProcterGamble' },
  { name: 'Johnson & Johnson', slug: 'JohnsonJohnson' },
  { name: 'Roche', slug: 'Roche' },
  { name: 'Novartis', slug: 'Novartis' },
  { name: 'Pfizer', slug: 'Pfizer' },
  { name: 'Merck', slug: 'Merck' },
  { name: 'Bristol Myers Squibb', slug: 'BristolMyersSquibb' },
  { name: 'AstraZeneca', slug: 'AstraZeneca' },
  { name: 'GSK', slug: 'GSK' },
  { name: 'Sanofi', slug: 'Sanofi' },
  { name: 'Bayer', slug: 'Bayer' },
  { name: 'BASF', slug: 'BASF' },
  { name: '3M', slug: '3M' },
  { name: 'Honeywell', slug: 'Honeywell' },
  { name: 'GE', slug: 'GE' },
  { name: 'Philips', slug: 'Philips' },
  { name: 'Sony', slug: 'Sony' },
  { name: 'Samsung', slug: 'Samsung' },
  { name: 'LG', slug: 'LG' },
  { name: 'Toyota', slug: 'Toyota' },
  { name: 'Honda', slug: 'Honda' },
  { name: 'Nissan', slug: 'Nissan' },
  { name: 'Salesforce', slug: 'Salesforce' },
  { name: 'Zendesk', slug: 'Zendesk' },
  { name: 'Atlassian', slug: 'Atlassian' },
  { name: 'John Deere', slug: 'JohnDeere' },
  { name: 'Caterpillar', slug: 'Caterpillar' },
];

const BREEZY_COMPANIES: ATSCompany[] = [
  { name: 'Buffer', slug: 'buffer' },
  { name: 'Ghost', slug: 'ghost' },
  { name: 'Baremetrics', slug: 'baremetrics' },
  { name: 'ConvertKit', slug: 'convertkit' },
  { name: 'Gumroad', slug: 'gumroad' },
  { name: 'Podia', slug: 'podia' },
  { name: 'Teachable', slug: 'teachable' },
  { name: 'Thinkific', slug: 'thinkific' },
  { name: 'Kajabi', slug: 'kajabi' },
  { name: 'ClickFunnels', slug: 'clickfunnels' },
  { name: 'Leadpages', slug: 'leadpages' },
  { name: 'Unbounce', slug: 'unbounce' },
  { name: 'Elementor', slug: 'elementor' },
  { name: 'Divi', slug: 'divi' },
  { name: 'Beaver Builder', slug: 'beaverbuilder' },
  { name: 'StudioPress', slug: 'studiopress' },
  { name: 'Genesis', slug: 'genesis' },
  { name: 'Elegant Themes', slug: 'elegantthemes' },
  { name: 'Themify', slug: 'themify' },
];

const BAMBOOHR_COMPANIES: ATSCompany[] = [
  { name: 'Asana', slug: 'asana' },
  { name: 'Medium', slug: 'medium' },
  { name: 'Buffer', slug: 'buffer' },
  { name: 'Zapier', slug: 'zapier' },
  { name: 'Automattic', slug: 'automattic' },
  { name: 'GitLab', slug: 'gitlab' },
  { name: 'InVision', slug: 'invision' },
  { name: 'Toptal', slug: 'toptal' },
  { name: 'Crossover', slug: 'crossover' },
  { name: 'Turing', slug: 'turing' },
  { name: 'Andela', slug: 'andela' },
  { name: 'Upwork', slug: 'upwork' },
  { name: 'Fiverr', slug: 'fiverr' },
  { name: 'Freelancer', slug: 'freelancer' },
  { name: 'PeoplePerHour', slug: 'peopleperhour' },
  { name: '99designs', slug: '99designs' },
  { name: 'Canva', slug: 'canva' },
  { name: 'Adobe Spark', slug: 'adobespark' },
  { name: 'Snappa', slug: 'snappa' },
  { name: 'PicMonkey', slug: 'picmonkey' },
];

const TEAMTAILOR_COMPANIES: ATSCompany[] = [
  { name: 'Spotify', slug: 'spotify' },
  { name: 'Klarna', slug: 'klarna' },
  { name: 'iZettle', slug: 'izettle' },
  { name: 'Tink', slug: 'tink' },
  { name: 'Trustly', slug: 'trustly' },
  { name: 'Truecaller', slug: 'truecaller' },
  { name: 'King', slug: 'king' },
  { name: 'Mojang', slug: 'mojang' },
  { name: 'Paradox', slug: 'paradox' },
  { name: 'Fatshark', slug: 'fatshark' },
  { name: 'Avalanche', slug: 'avalanche' },
  { name: 'MachineGames', slug: 'machinegames' },
  { name: 'Starbreeze', slug: 'starbreeze' },
  { name: 'Playground Games', slug: 'playgroundgames' },
  { name: 'Rare', slug: 'rare' },
  { name: 'Obsidian', slug: 'obsidian' },
  { name: 'inXile', slug: 'inxile' },
  { name: 'Double Fine', slug: 'doublefine' },
  { name: 'Ninja Theory', slug: 'ninjatheory' },
  { name: 'Compulsion', slug: 'compulsion' },
  { name: 'Undead Labs', slug: 'undeadlabs' },
  { name: 'Bethesda', slug: 'bethesda' },
  { name: 'id Software', slug: 'idsoftware' },
  { name: 'Arkane', slug: 'arkane' },
  { name: 'Tango', slug: 'tango' },
  { name: 'Superhuman', slug: 'superhuman' },
  { name: 'TheyDo', slug: 'theydo' },
];

/** ATS scraper configuration: selectors and URL structure */
export const ATS_CONFIG: Record<string, ATSConfigItem> = {
  greenhouse: {
    name: 'Greenhouse',
    baseUrl: 'https://boards.greenhouse.io',
    jobListPath: '/{company}',
    selectors: {
      jobContainer: '.opening',
      title: '.opening a',
      location: '.location',
      department: '.department',
      link: '.opening a',
    },
    pagination: false,
    apiAvailable: true,
  },
  lever: {
    name: 'Lever',
    baseUrl: 'https://jobs.lever.co',
    jobListPath: '/{company}',
    selectors: {
      jobContainer: '.posting',
      title: '.posting-title h5',
      location: '.posting-categories span',
      department: '.posting-categories span',
      link: '.posting a',
    },
    pagination: false,
    apiAvailable: true,
  },
  ashby: {
    name: 'Ashby',
    baseUrl: 'https://jobs.ashbyhq.com',
    jobListPath: '/{company}',
    selectors: {
      jobContainer: '[data-testid="job-card"]',
      title: 'h3',
      location: '[data-testid="job-location"]',
      department: '[data-testid="job-department"]',
      link: 'a',
    },
    pagination: true,
    apiAvailable: true,
  },
  workable: {
    name: 'Workable',
    baseUrl: 'https://apply.workable.com',
    jobListPath: '/{company}',
    selectors: {
      jobContainer: '.job',
      title: 'h3',
      location: '.location',
      department: '.department',
      link: 'a',
    },
    pagination: true,
    apiAvailable: true,
  },
  smartrecruiters: {
    name: 'SmartRecruiters',
    baseUrl: 'https://careers.smartrecruiters.com',
    jobListPath: '/{company}',
    selectors: {
      jobContainer: '.job-title',
      title: 'a',
      location: '.job-location',
      department: '.job-department',
      link: 'a',
    },
    pagination: true,
    apiAvailable: true,
  },
  breezy: {
    name: 'Breezy HR',
    baseUrl: 'https://{company}.breezy.hr',
    jobListPath: '',
    selectors: {
      jobContainer: '.position',
      title: 'h2',
      location: '.location',
      department: '.department',
      link: 'a',
    },
    pagination: false,
    apiAvailable: false,
  },
  bamboohr: {
    name: 'BambooHR',
    baseUrl: 'https://{company}.bamboohr.com',
    jobListPath: '/jobs',
    selectors: {
      jobContainer: '.job',
      title: 'h2',
      location: '.location',
      department: '.department',
      link: 'a',
    },
    pagination: false,
    apiAvailable: true,
  },
  teamtailor: {
    name: 'Teamtailor',
    baseUrl: 'https://{company}.teamtailor.com',
    jobListPath: '',
    selectors: {
      jobContainer: '.job-card',
      title: 'h3',
      location: '.location',
      department: '.department',
      link: 'a',
    },
    pagination: true,
    apiAvailable: true,
  },
};

const ATS_COMPANIES: Record<string, ATSCompany[]> = {
  greenhouse: GREENHOUSE_COMPANIES,
  lever: LEVER_COMPANIES,
  ashby: ASHBY_COMPANIES,
  workable: WORKABLE_COMPANIES,
  smartrecruiters: SMARTRECRUITERS_COMPANIES,
  breezy: BREEZY_COMPANIES,
  bamboohr: BAMBOOHR_COMPANIES,
  teamtailor: TEAMTAILOR_COMPANIES,
};

/**
 * Build full URL for an ATS company board.
 */
export function getATSBoardUrl(atsKey: string, companySlug: string): string {
  const config = ATS_CONFIG[atsKey];
  if (!config) return '';

  const path = config.jobListPath.replace('{company}', companySlug);
  const base = config.baseUrl.includes('{company}')
    ? config.baseUrl.replace('{company}', companySlug)
    : config.baseUrl;
  return `${base}${path}`;
}

/**
 * Get company slug for URL (SmartRecruiters etc. may use PascalCase slug).
 */
export function getATSCompanySlug(_atsKey: string, company: ATSCompany): string {
  return company.slug;
}

/**
 * Build JobSource[] for all ATS boards (one source per company per ATS).
 */
export function buildATSSources(): JobSource[] {
  const sources: JobSource[] = [];

  for (const [atsKey, config] of Object.entries(ATS_CONFIG)) {
    const companies = ATS_COMPANIES[atsKey];
    if (!companies) continue;

    const category = `ATS - ${config.name}`;

    for (const company of companies) {
      const slug = getATSCompanySlug(atsKey, company);
      const url = getATSBoardUrl(atsKey, slug);
      const id = `${atsKey}-${slug}`.toLowerCase().replace(/\s+/g, '');
      sources.push({
        id,
        name: `${company.name} (${config.name})`,
        url,
        type: 'ats',
        enabled: true,
        category,
        description: `${config.name} job board for ${company.name}`,
        ats: atsKey,
        companySlug: slug,
        companyName: company.name,
      });
    }
  }

  return sources;
}
